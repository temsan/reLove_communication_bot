# üéØ –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã fine-tuning

**–î–∞—Ç–∞—Å–µ—Ç –≥–æ—Ç–æ–≤!** –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –°—Ç–∞—Ç—É—Å | –°—Ç–æ–∏–º–æ—Å—Ç—å | –í—Ä–µ–º—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-----------|--------|----------|-------|-----------|-------------|
| **OpenAI** | ‚úÖ –ì–æ—Ç–æ–≤ | $15-20 | 2-3 —á | ‚≠ê –õ–µ–≥–∫–æ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **Vertex AI** | ‚úÖ –ì–æ—Ç–æ–≤ | $15-30 | 1-2 —á | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω–µ | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **–õ–æ–∫–∞–ª—å–Ω–æ** | ‚úÖ –ì–æ—Ç–æ–≤ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | 30–º-2—á | ‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ | ‚≠ê‚≠ê‚≠ê |

---

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 1: OpenAI (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ü–µ—Å—Å
- –§–∞–π–ª —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω
- –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- **Fine-tuning**: ~$10-15
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: ~$0.50-1
- **–ò—Ç–æ–≥–æ**: ~$15-20

### ‚è±Ô∏è –í—Ä–µ–º—è

- **–ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–Ω–∞**: ~5 –º–∏–Ω—É—Ç
- **Fine-tuning**: ~2-3 —á–∞—Å–∞
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: ~5 –º–∏–Ω—É—Ç

### üöÄ –ó–∞–ø—É—Å–∫

```bash
# 1. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
# https://platform.openai.com/account/billing/overview

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å fine-tuning
python scripts/analysis/upload_and_finetune_natasha.py
```

### üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `QUICK_START.md` ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- `FINETUNE_INSTRUCTIONS.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- `OPENAI_UPGRADE_INSTRUCTIONS.md` ‚Äî –∫–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

---

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 2: Google Vertex AI

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ë—ã—Å—Ç—Ä–µ–µ —á–µ–º OpenAI
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Cloud
- –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –ì–∏–±–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –¢—Ä–µ–±—É–µ—Ç Google Cloud Project
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å GCS bucket

### üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- **Fine-tuning**: ~$10-20
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: ~$5-10
- **Storage**: ~$0.02/GB/–º–µ—Å—è—Ü
- **–ò—Ç–æ–≥–æ**: ~$15-30

### ‚è±Ô∏è –í—Ä–µ–º—è

- **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**: ~10 –º–∏–Ω—É—Ç
- **Fine-tuning**: ~1-2 —á–∞—Å–∞
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: ~5 –º–∏–Ω—É—Ç

### üöÄ –ó–∞–ø—É—Å–∫

```bash
# 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (—Å–º. VERTEX_AI_INSTRUCTIONS.md)
gcloud auth application-default login
gsutil mb gs://natasha-finetuning-bucket

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å fine-tuning
python scripts/analysis/upload_and_finetune_vertex.py \
  --project-id YOUR_PROJECT_ID \
  --bucket natasha-finetuning-bucket
```

### üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `VERTEX_AI_INSTRUCTIONS.md` ‚Äî –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

---

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 3: –õ–æ–∫–∞–ª—å–Ω–æ–µ fine-tuning

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –†–∞–±–æ—Ç–∞–µ—Ç offline
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–π GPU

### ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –¢—Ä–µ–±—É–µ—Ç GPU (NVIDIA)
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ù—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±–ª–∞—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

### üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** (—Ç—Ä–µ–±—É–µ—Ç—Å—è GPU)

### ‚è±Ô∏è –í—Ä–µ–º—è

- **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**: ~30 –º–∏–Ω—É—Ç
- **Fine-tuning**: ~30 –º–∏–Ω—É—Ç - 2 —á–∞—Å–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç GPU)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: ~5 –º–∏–Ω—É—Ç

### üöÄ –ó–∞–ø—É—Å–∫

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install transformers torch peft

# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç
# data/natasha_finetuning_20251125_153356.jsonl

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å fine-tuning
# (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Hugging Face Trainer –∏–ª–∏ –∞–Ω–∞–ª–æ–≥)
```

### üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Hugging Face –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –î–∞—Ç–∞—Å–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üìä –î–∞—Ç–∞—Å–µ—Ç

–í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–∞—Ç–∞—Å–µ—Ç:

- **321 QA –ø–∞—Ä–∞**
- **355 –¥–∏–∞–ª–æ–≥–æ–≤**
- **27 –∫–∞–Ω–∞–ª–æ–≤**
- **92.7% –∫–∞—á–µ—Å—Ç–≤–æ**

### –§–∞–π–ª—ã

- ‚≠ê `data/natasha_finetuning_20251125_153356.jsonl` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª
- üìö `data/natasha_dialogs_dataset_20251125_153356.json` ‚Äî –ø–æ–ª–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
- üìä `data/natasha_dialogs_20251125_153356.csv` ‚Äî —Ç–∞–±–ª–∏—Ü–∞

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞: **OpenAI**

- –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π
- –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –•–æ—Ä–æ—à–∞—è —Ü–µ–Ω–∞
- –ë—ã—Å—Ç—Ä–æ

```bash
python scripts/analysis/upload_and_finetune_natasha.py
```

### –î–ª—è Google Cloud –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: **Vertex AI**

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Cloud
- –ë—ã—Å—Ç—Ä–µ–µ
- –ì–∏–±–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```bash
python scripts/analysis/upload_and_finetune_vertex.py \
  --project-id YOUR_PROJECT_ID \
  --bucket natasha-finetuning-bucket
```

### –î–ª—è —ç–∫–æ–Ω–æ–º–Ω—ã—Ö: **–õ–æ–∫–∞–ª—å–Ω–æ**

- –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –¢—Ä–µ–±—É–µ—Ç—Å—è GPU
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

‚úÖ –î–∞—Ç–∞—Å–µ—Ç —Å–æ–±—Ä–∞–Ω  
‚úÖ –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω  
‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω  
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω –≤ –æ–±–ª–∞–∫–æ (OpenAI, Google)  
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω  

‚è≠Ô∏è –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä  
‚è≠Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å fine-tuning  
‚è≠Ô∏è –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è  
‚è≠Ô∏è –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å  
‚è≠Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ production  

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **OpenAI**: https://platform.openai.com/docs/guides/fine-tuning
- **Vertex AI**: https://cloud.google.com/vertex-ai/docs/generative-ai/models/gemini-supervised-tuning
- **–õ–æ–∫–∞–ª—å–Ω–æ**: https://huggingface.co/docs/transformers/training

---

**–í—ã–±–∏—Ä–∞–π—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏ –Ω–∞—á–∏–Ω–∞–π—Ç–µ!** üöÄ
