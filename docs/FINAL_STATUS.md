# –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å reLove Communication Bot

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞** - –±–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Telegram API
2. **–ö–æ–º–∞–Ω–¥–∞ /start** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–æ–±—ã—Ç–∏—è—Ö
3. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î** - PostgreSQL —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
4. **–§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏** - –≤—Å–µ 4 –∑–∞–¥–∞—á–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
5. **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** - PostgreSQL, Redis, Qdrant –∑–∞–ø—É—â–µ–Ω—ã

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç LLM
**–ü—Ä–æ–±–ª–µ–º–∞:** `generate_rag_answer` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –ø—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –≤–æ–ø—Ä–æ—Å
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç —Å fallback —Å–æ–æ–±—â–µ–Ω–∏–µ–º

### 2. –ö–æ–Ω—Ñ–ª–∏–∫—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–æ—Ç–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** Telegram —Å–æ–æ–±—â–∞–µ—Ç –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ - –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–µ–¥—ã–¥—É—â–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –Ω–µ –±—ã–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
**–†–µ—à–µ–Ω–∏–µ:** –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–æ–≤–æ–≥–æ

## üìù –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

1. ‚úÖ `'User' object has no attribute 'context'` ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é `markers`
2. ‚úÖ `UserActivityLog has no attribute 'summary'` ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é `details`
3. ‚úÖ `name 'generate_rag_answer' is not defined` ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ `llm.generate_rag_answer()`
4. ‚úÖ `message text is empty` ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
- –§—É–Ω–∫—Ü–∏—è `generate_rag_answer` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á–µ–º—É `relove_context` –ø—É—Å—Ç–æ–π
- –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ LLM –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–µ–π—á–∞—Å –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç fallback —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ—Ñ–∏–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É `ProfileService.analyze_profile()`

## üìä –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
- ‚úÖ BOT_TOKEN - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ DB_URL - –Ω–∞—Å—Ç—Ä–æ–µ–Ω (PostgreSQL)
- ‚úÖ LLM_API_KEY - –Ω–∞—Å—Ç—Ä–æ–µ–Ω (OpenRouter)
- ‚úÖ TG_API_ID, TG_API_HASH - –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- ‚úÖ relove_postgres (–ø–æ—Ä—Ç 5432) - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ redis (–ø–æ—Ä—Ç 6379) - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ qdrant (–ø–æ—Ä—Ç—ã 6333-6334) - —Ä–∞–±–æ—Ç–∞–µ—Ç

### –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- ‚úÖ Profile rotation - –∑–∞–ø—É—â–µ–Ω–∞
- ‚úÖ Log archive - –∑–∞–ø—É—â–µ–Ω–∞
- ‚úÖ Proactive triggers - –∑–∞–ø—É—â–µ–Ω–∞
- ‚úÖ Proactive messages - –∑–∞–ø—É—â–µ–Ω–∞

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
python -m relove_bot
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
```bash
# –ß–µ—Ä–µ–∑ Kiro
listProcesses ‚Üí stop

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
taskkill /F /IM python.exe
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
Get-Content logs/bot.log -Tail 100
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
docker-compose restart redis qdrant
docker start relove_postgres
```

## üìû –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ LLM
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –º–µ–Ω—é
4. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –≤—Å–µ—Ö callback query
5. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –ë–î

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `DEPLOYMENT_SUMMARY.md` - –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
- `PROFILE_UPDATE_STRATEGY.md` - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π
- `DOCKER_SETUP.md` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Docker
- `logs/bot.log` - –ª–æ–≥–∏ –±–æ—Ç–∞
