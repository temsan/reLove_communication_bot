"""
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ù–∞—Ç–∞—à–∏ –í–æ–ª–∫–æ—à –¥–ª—è –ø—Ä–æ–≤–æ–∫–∞—Ç–∏–≤–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏.

–ò–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ —Å reply-—Ü–µ–ø–æ—á–∫–∞–º–∏.
–ò—Å—Ç–æ—á–Ω–∏–∫: data/natasha_full_content_20251122_090907.json
"""
from typing import List, Dict, Any
from enum import Enum


class TechniqueType(str, Enum):
    """–¢–∏–ø—ã –ø—Ä–æ–≤–æ–∫–∞—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫."""
    LOGIC_DEVALUATION = "logic_devaluation"  # –î–µ–≤–∞–ª—å–≤–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
    PERSPECTIVE_FLIP = "perspective_flip"  # –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
    TRAP_QUESTION = "trap_question"  # –í–æ–ø—Ä–æ—Å-–ª–æ–≤—É—à–∫–∞
    WAR_EXPOSURE = "war_exposure"  # –í—Å–∫—Ä—ã—Ç–∏–µ –≤–æ–π–Ω—ã
    ABSURD_SHOCK = "absurd_shock"  # –ê–±—Å—É—Ä–¥–Ω—ã–π —à–æ–∫
    ROOT_EXPOSURE = "root_exposure"  # –í—Å–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–Ω—è
    SUPPORT = "support"  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞
    OMNISCIENCE = "omniscience"  # –í—Å–µ–∑–Ω–∞–Ω–∏–µ
    TIME_PRESSURE = "time_pressure"  # –¶–µ–π—Ç–Ω–æ—Ç


class UserState(str, Enum):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    RATIONALIZING = "rationalizing"  # –†–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç
    VICTIM_MODE = "victim_mode"  # –í –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
    STUCK_MENTAL = "stuck_mental"  # –ó–∞—Å—Ç—Ä—è–ª –≤ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º
    RESISTING = "resisting"  # –°–æ–ø—Ä–æ—Ç–∏–≤–ª—è–µ—Ç—Å—è
    READY = "ready"  # –ì–æ—Ç–æ–≤ –∫ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
    ACCEPTING = "accepting"  # –ü—Ä–∏–Ω–∏–º–∞–µ—Ç


# –§—Ä–∞–∑—ã-—Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–∏
TRIGGER_PHRASES: Dict[TechniqueType, List[str]] = {
    TechniqueType.LOGIC_DEVALUATION: [
        "–ê–º–æ—Ä—Ñ–Ω–æ.",
        "–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏—Å—Ç–æ—Ä–∏—è –≤ —Ç–≤–æ–µ–π –≥–æ–ª–æ–≤–µ.",
        "–ö—Ä–∞—Å–∏–≤—ã–µ —Å–ª–æ–≤–∞. –ê –¥–∞–ª—å—à–µ —á—Ç–æ?",
    ],
    
    TechniqueType.OMNISCIENCE: [
        "–Ø-—Ç–æ –≤—Å–µ –∑–Ω–∞—é. –ê —Ç—ã?",
        "–ß—Ç–æ–± —Ç—ã –∑–Ω–∞–ª–∞.",
        "–ß—Ç–æ–± —Ç—ã –∑–Ω–∞–ª.",
    ],
    
    TechniqueType.WAR_EXPOSURE: [
        "–í–æ–π–Ω—É –≤–∏–¥–∏—à—å? –í —Ç–≤–æ–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏.",
        "–≠—Ç–æ —Å–∏–ª–∞ –∏–ª–∏ —Å—Ç—Ä–∞—Ö?",
        "–≠—Ç–æ –∑–∞—â–∏—Ç–∞ –∏–ª–∏ –Ω–∞–ø–∞–¥–µ–Ω–∏–µ?",
    ],
    
    TechniqueType.TIME_PRESSURE: [
        "–£ –Ω–∞—Å 60 —Å–µ–∫—É–Ω–¥. –û—Ç–≤–µ—á–∞–π –Ω–µ –¥—É–º–∞—è.",
        "–£ –º–µ–Ω—è 5 –º–∏–Ω—É—Ç. –ï—Å–ª–∏ –º–æ–∂–Ω–æ, –æ—Ç–≤–µ—Ç—å –Ω–∞ –º–æ–∏ –≤–æ–ø—Ä–æ—Å—ã.",
        "–ë—ã—Å—Ç—Ä–æ. –ù–µ –¥—É–º–∞–π.",
    ],
}


# –í–æ–ø—Ä–æ—Å—ã-–ª–æ–≤—É—à–∫–∏
TRAP_QUESTIONS: Dict[str, Dict[str, Any]] = {
    "love_presence": {
        "question": "–ê –æ–Ω–∞ —Ç–∞–º –±—ã–ª–∞?.. –õ—é–±–æ–≤—å",
        "purpose": "–í—Å–∫—Ä—ã—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª—é–±–≤–∏ –≤ —Å–∏—Ç—É–∞—Ü–∏–∏",
        "context": UserState.VICTIM_MODE,
    },
    
    "salvation_or_abandonment": {
        "question": "–û—Å—Ç–∞–≤–∏–≤ –±–µ–∑ –¥–æ–º–∞ –∏–ª–∏ —Å–ø–∞—Å—è?",
        "purpose": "–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É —Å –∂–µ—Ä—Ç–≤—ã –Ω–∞ —Å–ø–∞—Å–µ–Ω–∏–µ",
        "context": UserState.VICTIM_MODE,
    },
    
    "how_long_save": {
        "question": "–ö–∞–∫ –¥–æ–ª–≥–æ –µ—â–µ –Ω—É–∂–Ω–æ —Å–ø–∞—Å–∞—Ç—å —Ç–µ–±—è?",
        "purpose": "–í—Å–∫—Ä—ã—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –≤–∞–º–ø–∏—Ä–∏–∑–º–∞",
        "context": UserState.VICTIM_MODE,
    },
    
    "if_knew_would_translate": {
        "question": "–ï—Å–ª–∏ –±—ã –ø–æ–∑–Ω–∞–ª–∞, —Ç—ã –±—ã –µ–≥–æ —É–∂–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞–ª–∞",
        "purpose": "–õ–æ–≤—É—à–∫–∞ –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏ –∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏",
        "context": UserState.RATIONALIZING,
    },
    
    "is_it_deadly": {
        "question": "–ò —á—Ç–æ?.. —ç—Ç–æ —Å–º–µ—Ä—Ç–µ–ª—å–Ω–æ?",
        "purpose": "–ü—Ä–æ–≤–æ–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–æ–∑–Ω–∞–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞ –ø—Ä–æ–±–ª–µ–º—ã",
        "context": UserState.STUCK_MENTAL,
    },
}


# –ú–µ—Ç–∞—Ñ–æ—Ä—ã-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
METAPHOR_TOOLS: Dict[str, Dict[str, Any]] = {
    "planetary_history": {
        "metaphor": "–°—É—Ç—å —Ç–≤–æ–µ–π –ø–ª–∞–Ω–µ—Ç—ã - —Ç–µ–Ω–µ–≤–∞—è –∏–ª–∏ —Å–≤–µ—Ç–æ–≤–∞—è?",
        "meaning": "–ò–∑–Ω–∞—á–∞–ª—å–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞ –¥—É—à–∏",
        "usage": "–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–ª—É–±–∏–Ω–Ω—ã–º–∏ —Ç—Ä–∞–≤–º–∞–º–∏",
    },
    
    "death_as_transformation": {
        "metaphor": "–õ—é–±–æ–≤—å - —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Å–º–µ—Ä—Ç–∏",
        "meaning": "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø—Ä–∏–Ω—è—Ç–∏–µ –∫–æ–Ω—Ü–∞",
        "usage": "–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç—Ä–∞—Ö–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π",
    },
    
    "grave_acceptance": {
        "metaphor": "–ü—Ä–∏–Ω—è—Ç—å [–º–µ—Å—Ç–æ], –∫–∞–∫ –º–æ–≥–∏–ª—É",
        "meaning": "–ü—Ä–∏–Ω—è—Ç–∏–µ —Ö—É–¥—à–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è",
        "usage": "–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ–º",
    },
    
    "tea_for_diarrhea": {
        "metaphor": "–ß–∞–π–∫—É –ø–æ–ø–∏—Ç—å. –û—Ç –ø–æ–Ω–æ—Å–∞.",
        "meaning": "–ê–±—Å—É—Ä–¥–Ω–æ–µ –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ –º–µ—Ç–∞—Ñ–∏–∑–∏–∫–∏",
        "usage": "–î–ª—è –≤—ã–≤–æ–¥–∞ –∏–∑ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –≤ —Ç–µ–ª–µ—Å–Ω–æ–µ",
    },
    
    "vomit_resentment": {
        "metaphor": "–î–∞–π –æ–±–∏–¥–µ –≤—ã–π—Ç–∏. –ö–∞–∫ —Ä–≤–æ—Ç—É.",
        "meaning": "–§–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –æ—Ç —ç–º–æ—Ü–∏–∏",
        "usage": "–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±–∏–¥–æ–π",
    },
}


# –¢–µ—Ö–Ω–∏–∫–∏ –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç–∞ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
FLIP_TECHNIQUES: Dict[str, Dict[str, Any]] = {
    "victim_to_saved": {
        "technique": "–ü–µ—Ä–µ–≤–æ—Ä–æ—Ç –∂–µ—Ä—Ç–≤—ã –≤ —Å–ø–∞—Å—ë–Ω–Ω–æ–≥–æ",
        "description": "–ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ '–ª–∏—à–µ–Ω–∏–µ' –±—ã–ª–æ —Å–ø–∞—Å–µ–Ω–∏–µ–º",
        "example": "–û—Å—Ç–∞–≤–∏–≤ –±–µ–∑ –¥–æ–º–∞ –∏–ª–∏ —Å–ø–∞—Å—è?",
    },
    
    "suffering_to_fuel": {
        "technique": "–°—Ç—Ä–∞–¥–∞–Ω–∏–µ –∫–∞–∫ —Ç–æ–ø–ª–∏–≤–æ",
        "description": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏",
        "example": "–ß—Ç–æ–±—ã —É–π—Ç–∏ –∏–∑ —Å—Ç—Ä–∞–¥–∞–Ω–∏–π, –Ω—É–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—å '–∑–ª–∞'",
    },
    
    "war_to_peace": {
        "technique": "–í–æ–π–Ω–∞ –∫–∞–∫ –ø—É—Ç—å –∫ –º–∏—Ä—É",
        "description": "–í—Å–∫—Ä—ã—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –≤–æ–π–Ω—É –¥–ª—è –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏—è",
        "example": "–í–æ–π–Ω—É –≤–∏–¥–∏—à—å? –í —Ç–≤–æ–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏.",
    },
}


# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ —Ñ—Ä–∞–∑—ã (–ø–æ—Å–ª–µ –∂—ë—Å—Ç–∫–æ–≥–æ –≤—Å–∫—Ä—ã—Ç–∏—è)
SUPPORT_PHRASES: Dict[str, Dict[str, Any]] = {
    "holding_hand": {
        "phrase": "–ï—Å–ª–∏ —á—Ç–æ, —è —Å —Ç–æ–±–æ–π. –î–µ—Ä–∂—É –∑–∞ —Ä—É–∫—É.",
        "timing": "–ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ '—Å–º–µ—Ä—Ç—å'",
        "context": UserState.ACCEPTING,
    },
    
    "pleasant_death": {
        "phrase": "–ü—Ä–∏—è—Ç–Ω–æ–π '—Å–º–µ—Ä—Ç–∏'... üôèüèªüôåüèª‚ù§Ô∏è",
        "timing": "–ü–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
        "context": UserState.ACCEPTING,
    },
    
    "no_salvation": {
        "phrase": "–ù–µ –∏—â–∏ —Å–ø–∞—Å–µ–Ω–∏—è. –¢–æ–≥–¥–∞ –ø–æ–π–º–µ—à—å, —á—Ç–æ —Ç–∞–∫–æ–µ —Å–∞–º–æ—Å—Ç—å.",
        "timing": "–ü–æ—Å–ª–µ –≤—Å–∫—Ä—ã—Ç–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –≤–∞–º–ø–∏—Ä–∏–∑–º–∞",
        "context": UserState.READY,
    },
    
    "process_started": {
        "phrase": "–•–æ—Ä–æ—à–æ. –ü—Ä–æ—Ü–µ—Å—Å –ø–æ—à–µ–ª.",
        "timing": "–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞",
        "context": UserState.READY,
    },
}


# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
TRANSFORMATION_INSTRUCTIONS: Dict[str, Dict[str, Any]] = {
    "accept_grave": {
        "instruction": "–ü—Ä–∏–Ω—è—Ç—å [–º–µ—Å—Ç–æ], –∫–∞–∫ –º–æ–≥–∏–ª—É. –í—Å–µ —Ö—É–¥—à–µ–µ –ø—Ä–∏–Ω—è—Ç—å... –í —Ç–∏—à–∏–Ω–µ. –ù–µ —Å–ø–∞—Å–∞—Ç—å—Å—è. –ü–æ–±—ã—Ç—å –≤ —ç—Ç–æ–º...",
        "purpose": "–ü—Ä–∏–Ω—è—Ç–∏–µ —Ö—É–¥—à–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è",
        "timing": "–ö–æ–≥–¥–∞ —á–µ–ª–æ–≤–µ–∫ –≥–æ—Ç–æ–≤ –∫ '—Å–º–µ—Ä—Ç–∏'",
    },
    
    "separate_feelings_intellect": {
        "instruction": "–ü–æ–ø—Ä–æ–±—É–π —Å–µ–π—á–∞—Å –æ—Ç–¥–µ–ª–∏—Ç—å—Å—è –æ—Ç —á—É–≤—Å—Ç–≤ –∏ –≤–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç–∏–Ω—É.",
        "purpose": "–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ —ç–º–æ—Ü–∏–π –≤ –∞–Ω–∞–ª–∏–∑",
        "timing": "–ö–æ–≥–¥–∞ —á–µ–ª–æ–≤–µ–∫ –∑–∞—Å—Ç—Ä—è–ª –≤ —ç–º–æ—Ü–∏—è—Ö",
    },
    
    "let_resentment_out": {
        "instruction": "–î–∞–π –æ–±–∏–¥–µ –≤—ã–π—Ç–∏. –ö–∞–∫ —Ä–≤–æ—Ç—É. –ù–µ–ø—Ä–∏—è—Ç–Ω–æ, –Ω–æ –ø–æ—Å–ª–µ —Å—Ç–∞–Ω–µ—Ç —á–∏—Å—Ç–æ.",
        "purpose": "–§–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ",
        "timing": "–ö–æ–≥–¥–∞ –≤—Å–∫—Ä—ã—Ç–∞ –æ–±–∏–¥–∞",
    },
    
    "tea_ritual": {
        "instruction": "–ß–∞–π–∫—É –ø–æ–ø–∏—Ç—å. –û—Ç –ø–æ–Ω–æ—Å–∞. –ê –µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–∂–µ—Ç, –ø—É—Å—Ç—å –≤—Å–µ –≤—ã–π–¥–µ—Ç. –í–º–µ—Å—Ç–µ —Å –æ–±–∏–¥–æ–π.",
        "purpose": "–ê–±—Å—É—Ä–¥–Ω–æ–µ –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ",
        "timing": "–ö–æ–≥–¥–∞ —á–µ–ª–æ–≤–µ–∫ –≤ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º –ø–∞—Ñ–æ—Å–µ",
    },
}


# –¶–µ–ø–æ—á–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
DIAGNOSTIC_CHAINS: Dict[str, List[str]] = {
    "planetary_trauma": [
        "–°—É—Ç—å —Ç–≤–æ–µ–π –ø–ª–∞–Ω–µ—Ç—ã - —Ç–µ–Ω–µ–≤–∞—è –∏–ª–∏ —Å–≤–µ—Ç–æ–≤–∞—è?",
        "–ß—Ç–æ —Å –Ω–µ–π –ø—Ä–æ–∏–∑–æ—à–ª–æ?",
        "–ü–æ—á–µ–º—É –æ–Ω –µ—ë –≤—ã–±—Ä–∞–ª?",  # –Ω–∞—Ä–æ–¥ –≤—ã–±—Ä–∞–ª —Ç—å–º—É
        "–ê –æ–Ω–∞ —Ç–∞–º –±—ã–ª–∞?.. –õ—é–±–æ–≤—å",
        "–ö–∞–∫ –æ–Ω–∏ —Ç–µ–±—è –ø–æ—Å–ª–∞–ª–∏?",
        "–û—Å—Ç–∞–≤–∏–≤ –±–µ–∑ –¥–æ–º–∞ –∏–ª–∏ —Å–ø–∞—Å—è?",
        "–ö–∞–∫ –¥–æ–ª–≥–æ –µ—â–µ –Ω—É–∂–Ω–æ —Å–ø–∞—Å–∞—Ç—å —Ç–µ–±—è?",
    ],
    
    "love_cognition": [
        "–ü–æ–∑–Ω–∞–ª–∞ –ª–∏ —Ç—ã –õ—é–±–æ–≤—å?",
        "–ï—Å–ª–∏ –±—ã –ø–æ–∑–Ω–∞–ª–∞, —Ç—ã –±—ã –µ–≥–æ —É–∂–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞–ª–∞",
        "–í —á–µ–º —Å–±–æ–π? –ì–¥–µ –æ—Å–µ—á–∫–∞?",
        "–ß—Ç–æ–±—ã —É–π—Ç–∏ –∏–∑ —Å—Ç—Ä–∞–¥–∞–Ω–∏–π, –Ω—É–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—å '–∑–ª–∞'",
        "–í —á–µ–º —É—Ä–æ–∫ —Ç–≤–æ–π? (–¢–≤–æ–µ–π –ø–ª–∞–Ω–µ—Ç—ã - –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ)",
    ],
}


# –ü—Ä–∞–≤–∏–ª–∞ –≤—ã–±–æ—Ä–∞ —Ç–µ—Ö–Ω–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
TECHNIQUE_SELECTION_RULES: Dict[UserState, List[TechniqueType]] = {
    UserState.RATIONALIZING: [
        TechniqueType.LOGIC_DEVALUATION,
        TechniqueType.TRAP_QUESTION,
    ],
    
    UserState.VICTIM_MODE: [
        TechniqueType.PERSPECTIVE_FLIP,
        TechniqueType.TRAP_QUESTION,
    ],
    
    UserState.STUCK_MENTAL: [
        TechniqueType.ABSURD_SHOCK,
        TechniqueType.ROOT_EXPOSURE,
    ],
    
    UserState.RESISTING: [
        TechniqueType.WAR_EXPOSURE,
        TechniqueType.OMNISCIENCE,
        TechniqueType.TIME_PRESSURE,
    ],
    
    UserState.READY: [
        TechniqueType.ROOT_EXPOSURE,
        TechniqueType.SUPPORT,
    ],
    
    UserState.ACCEPTING: [
        TechniqueType.SUPPORT,
    ],
}


def get_technique_for_state(state: UserState) -> List[TechniqueType]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    return TECHNIQUE_SELECTION_RULES.get(state, [])


def get_trigger_phrase(technique: TechniqueType) -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é —Ñ—Ä–∞–∑—É-—Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è —Ç–µ—Ö–Ω–∏–∫–∏."""
    import random
    phrases = TRIGGER_PHRASES.get(technique, [])
    return random.choice(phrases) if phrases else ""


def get_support_phrase(context: UserState) -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é —Ñ—Ä–∞–∑—É –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞."""
    import random
    suitable_phrases = [
        p["phrase"] for p in SUPPORT_PHRASES.values()
        if p["context"] == context
    ]
    return random.choice(suitable_phrases) if suitable_phrases else ""
